!function(e){var t={};function i(l){if(t[l])return t[l].exports;var a=t[l]={i:l,l:!1,exports:{}};return e[l].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=t,i.d=function(e,t,l){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:l})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var l=Object.create(null);if(i.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(l,a,function(t){return e[t]}.bind(null,a));return l},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/",i(i.s=0)}({0:function(e,t,i){i("WfG0"),e.exports=i("zcrr")},WfG0:function(e,t,i){"use strict";i.r(t);var l=biigle.$require("core.mixins.editor"),a=biigle.$require("events"),n=biigle.$require("messages").handleErrorResponse,s=biigle.$require("keyboard"),r=biigle.$require("api.labels"),o=biigle.$require("api.labelSource"),c=biigle.$require("api.labelTree"),u=biigle.$require("core.mixins.loader"),d=biigle.$require("api.projects"),h=biigle.$require("core.components.typeahead"),f={mixins:[h],props:{template:{default:'<span class="label-typeahead-item"><span v-if="item.color" :style="{\'background-color\': \'#\' + item.color}" class="label-color"></span><span v-text="item.name"></span></span>'}}},b={template:'<div class="label-tree">\n        <h4 class="label-tree__title" v-if="showTitle">\n            <button v-if="collapsible" @click.stop="collapse" class="btn btn-default btn-xs pull-right" :title="collapseTitle" type="button">\n                <span v-if="collapsed" class="fa fa-chevron-down" aria-hidden="true"></span>\n                <span v-else class="fa fa-chevron-up" aria-hidden="true"></span>\n            </button>\n            {{name}}\n        </h4>\n        <ul v-if="!collapsed" class="label-tree__list">\n            <label-tree-label :key="label.id" :label="label" :editable="editable" :show-favourites="showFavourites" :flat="flat" v-for="label in rootLabels" @select="emitSelect" @deselect="emitDeselect" @save="emitSave" @delete="emitDelete" @add-favourite="emitAddFavourite" @remove-favourite="emitRemoveFavourite"></label-tree-label>\n            <li v-if="hasNoLabels" class="text-muted">No labels</li>\n        </ul>\n    </div>',data:function(){return{collapsed:!1}},components:{labelTreeLabel:{name:"label-tree-label",template:'<li class="label-tree-label" :class="classObject">\n        <div class="label-tree-label__name" @click="toggleOpen" @mouseover="doHover" @mouseleave="dontHover">\n            <span v-if="editing">\n                <input type="color" class="form-control input-sm label-tree-color-input" v-model="newColor" />\n                <input type="text" v-model="newName" v-on:keydown.enter="saveThis" class="form-control input-sm label-tree-label__name-input">\n            </span>\n            <span v-else>\n                <span v-show="showColor" class="label-tree-label__color" :style="colorStyle"></span>\n                <span v-show="showChevronDown" class="label-tree-label__chevron label-tree-label__chevron--down" :style="chevronStyle"></span>\n                <span v-show="showChevronUp" class="label-tree-label__chevron label-tree-label__chevron--up" :style="chevronStyle"></span>\n                <span v-text="label.name" @click.stop="toggleSelect" @mouseenter="dontHover"></span>\n            </span>\n            <span class="label-tree-label__buttons">\n                <button v-if="showFavourites" type="button" class="label-tree-label__favourite" :class="favouriteClass" @click.stop="toggleFavourite" :title="favouriteTitle">\n                    <span class="fa fa-star" aria-hidden="true" title=""></span>\n                </button>\n                <button v-if="editable && !editing" :title="editTitle" @click.stop="editThis"><span aria-hidden="true" class="fa fa-pencil-alt"></span></button>\n                <button v-if="editing" class="text-danger" :title="deleteTitle" @click.stop="deleteThis"><span aria-hidden="true" class="fa fa-trash"></span></button>\n                <button v-if="editing" title="Revert changes" @click.stop="revertThis"><span aria-hidden="true" class="fa fa-times"></span></button>\n                <button v-if="editing" class="text-success" title="Save changes" @click.stop="saveThis"><span aria-hidden="true" class="fa fa-check"></span></button>\n            </span>\n        </div>\n        <ul v-if="expandable && label.open" class="label-tree__list">\n            <label-tree-label :key="child.id" :label="child" :editable="editable" :show-favourites="showFavourites" v-for="child in label.children" @select="emitSelect" @deselect="emitDeselect" @save="emitSave" @delete="emitDelete" @add-favourite="emitAddFavourite" @remove-favourite="emitRemoveFavourite"></label-tree-label>\n        </ul>\n    </li>',data:function(){return{hover:!1,editing:!1,oldName:"",oldColor:"",newName:"",newColor:""}},props:{label:{type:Object,required:!0},showFavourites:{type:Boolean,required:!1},editable:{type:Boolean,default:!1},flat:{type:Boolean,default:!1}},computed:{showColor:function(){return!this.expandable||!this.hover},showChevronUp:function(){return!this.showColor&&this.label.open},showChevronDown:function(){return!this.showColor&&!this.label.open},classObject:function(){return{"label-tree-label--selected":this.label.selected,"label-tree-label--expandable":this.expandable,"label-tree-label--editing":this.editing}},colorStyle:function(){return{"background-color":"#"+this.label.color}},chevronStyle:function(){return{color:"#"+this.label.color}},favouriteClass:function(){return{selected:this.label.favourite}},favouriteTitle:function(){return(this.label.favourite?"Remove":"Add")+" as favourite"},editTitle:function(){return"Edit label "+this.label.name},deleteTitle:function(){return"Remove label "+this.label.name},expandable:function(){return!this.flat&&!!this.label.children}},methods:{toggleSelect:function(e){this.editing||(e.preventDefault(),this.label.selected?this.$emit("deselect",this.label,e):this.$emit("select",this.label,e))},editThis:function(){this.editing=!0,this.oldName=this.label.name,this.oldColor=this.label.color,this.newName=this.label.name,this.newColor="#"+this.label.color},saveThis:function(){var e=this;this.label.name=this.newName,this.label.color=this.newColor.substr(1),this.editing=!1,this.oldName===this.label.name&&this.oldColor===this.label.color||this.emitSave(this.label,(function(){return e.editing=!0}))},revertThis:function(){this.editing=!1,this.label.name=this.oldName,this.label.color=this.oldColor},deleteThis:function(){this.emitDelete(this.label)},toggleOpen:function(e){this.editing||(this.expandable?this.label.open=!this.label.open:this.toggleSelect(e))},toggleFavourite:function(){this.label.favourite?this.emitRemoveFavourite(this.label):this.emitAddFavourite(this.label)},emitSelect:function(e,t){this.$emit("select",e,t)},emitDeselect:function(e,t){this.$emit("deselect",e,t)},emitDelete:function(e){this.$emit("delete",e)},emitSave:function(e,t){this.$emit("save",e,t)},emitAddFavourite:function(e){this.$emit("add-favourite",e)},emitRemoveFavourite:function(e){this.$emit("remove-favourite",e)},doHover:function(){this.hover=!0},dontHover:function(){this.hover=!1}}}},props:{name:{type:String,required:!0},labels:{type:Array,required:!0},showTitle:{type:Boolean,default:!0},standalone:{type:Boolean,default:!1},collapsible:{type:Boolean,default:!0},multiselect:{type:Boolean,default:!1},allowSelectSiblings:{type:Boolean,default:!1},allowSelectChildren:{type:Boolean,default:!1},editable:{type:Boolean,default:!1},showFavourites:{type:Boolean,default:!1},flat:{type:Boolean,default:!1}},computed:{labelMap:function(){for(var e={},t=this.labels.length-1;t>=0;t--)e[this.labels[t].id]=this.labels[t];return e},compiledLabels:function(){var e={null:[]};return this.flat?this.labels.forEach((function(t){e.null.push(t)})):(this.labels.forEach((function(t){e.hasOwnProperty(t.parent_id)?e[t.parent_id].push(t):e[t.parent_id]=[t]})),this.labels.forEach((function(t){e.hasOwnProperty(t.id)?Vue.set(t,"children",e[t.id]):(Vue.set(t,"children",void 0),t.open=!1)}))),e},rootLabels:function(){return this.compiledLabels.null},collapseTitle:function(){return this.collapsed?"Expand":"Collapse"},hasNoLabels:function(){return 0===this.rootLabels.length}},methods:{hasLabel:function(e){return this.labelMap.hasOwnProperty(e)},getLabel:function(e){return this.labelMap[e]},getParents:function(e){for(var t=[];null!==e.parent_id;)e=this.getLabel(e.parent_id),t.unshift(e.id);return t},getSiblings:function(e){return null===e.parent_id?this.rootLabels:this.getLabel(e.parent_id).children},selectSiblings:function(e){this.getSiblings(e).forEach((function(e){e.selected=!0}))},deselectSiblings:function(e){this.getSiblings(e).forEach((function(e){e.selected=!1}))},selectChildren:function(e){var t=this;e.children&&e.children.forEach((function(e){e.selected=!0,t.selectChildren(e)}))},deselectChildren:function(e){var t=this;e.children&&e.children.forEach((function(e){e.selected=!1,t.deselectChildren(e)}))},emitSelect:function(e,t){this.$emit("select",e,t)},emitDeselect:function(e,t){this.$emit("deselect",e,t)},emitSave:function(e,t){this.$emit("save",e,t)},emitDelete:function(e){this.$emit("delete",e)},conditionSelectSiblings:function(e){return this.allowSelectSiblings&&e.altKey},conditionSelectChildren:function(e){return this.allowSelectChildren&&e.ctrlKey},selectLabel:function(e,t){var i=this;this.multiselect||this.clearSelectedLabels(),e&&this.hasLabel(e.id)&&(e.selected=!0,this.collapsed=!1,this.flat||(this.getParents(e).forEach((function(e){i.getLabel(e).open=!0})),this.multiselect&&(this.conditionSelectSiblings(t)&&this.selectSiblings(e),this.conditionSelectChildren(t)&&(this.selectChildren(e),this.conditionSelectSiblings(t)&&this.getSiblings(e).forEach(this.selectChildren)))))},deselectLabel:function(e,t){this.hasLabel(e.id)&&(e.selected=!1,this.conditionSelectSiblings(t)&&this.deselectSiblings(e),this.conditionSelectChildren(t)&&(this.deselectChildren(e),this.conditionSelectSiblings(t)&&this.getSiblings(e).forEach(this.deselectChildren)))},clearSelectedLabels:function(){this.labels.forEach((function(e){e.selected=!1}))},collapse:function(){if(this.collapsed)this.collapsed=!1;else{var e=!1;this.labels.forEach((function(t){e|=t.open,t.open=!1})),this.collapsed=!e}},emitAddFavourite:function(e){this.$emit("add-favourite",e)},emitRemoveFavourite:function(e){this.$emit("remove-favourite",e)},addFavouriteLabel:function(e){this.hasLabel(e.id)&&(e.favourite=!0)},removeFavouriteLabel:function(e){this.hasLabel(e.id)&&(e.favourite=!1)}},created:function(){this.labels.forEach((function(e){e.hasOwnProperty("open")||Vue.set(e,"open",!1),e.hasOwnProperty("selected")||Vue.set(e,"selected",!1),e.hasOwnProperty("favourite")||Vue.set(e,"favourite",!1)})),this.standalone?(this.$on("select",this.selectLabel),this.$on("deselect",this.deselectLabel)):(this.$parent.$on("select",this.selectLabel),this.$parent.$on("deselect",this.deselectLabel),this.$parent.$on("clear",this.clearSelectedLabels),this.$parent.$on("add-favourite",this.addFavouriteLabel),this.$parent.$on("remove-favourite",this.removeFavouriteLabel))}},p={template:'<div class="label-trees">\n        <div v-if="typeahead || clearable" class="label-trees__head">\n            <button v-if="clearable" @click="clear" class="btn btn-default" title="Clear selected labels" type="button"><span class="fa fa-times fa-fw" aria-hidden="true"></span></button>\n            <typeahead v-if="typeahead" :items="labels" :template="typeaheadTemplate" @select="handleSelect" placeholder="Find label"></typeahead>\n        </div>\n        <div class="label-trees__body">\n            <label-tree v-if="hasFavourites" name="Favourites" :labels="favourites" :show-favourites="showFavourites" :flat="true" :collapsible="collapsible" @select="handleSelect" @deselect="handleDeselect" @remove-favourite="handleRemoveFavourite"></label-tree>\n            <label-tree :name="tree.versionedName" :labels="tree.labels" :multiselect="multiselect" :allow-select-siblings="allowSelectSiblings" :allow-select-children="allowSelectChildren" :show-favourites="showFavourites" :collapsible="collapsible" v-for="tree in trees" @select="handleSelect" @deselect="handleDeselect"  @add-favourite="handleAddFavourite" @remove-favourite="handleRemoveFavourite"></label-tree>\n        </div>\n    </div>',components:{typeahead:f,labelTree:b},data:function(){return{favourites:[],typeaheadTemplate:'<span v-text="item.name"></span><br><small v-text="item.tree.versionedName"></small>'}},props:{trees:{type:Array,required:!0},id:{type:String},typeahead:{type:Boolean,default:!0},clearable:{type:Boolean,default:!0},multiselect:{type:Boolean,default:!1},allowSelectSiblings:{type:Boolean,default:!1},allowSelectChildren:{type:Boolean,default:!1},showFavourites:{type:Boolean,default:!1},collapsible:{type:Boolean,default:!0},listenerSet:{type:String,default:"default"}},computed:{localeCompareSupportsLocales:function(){try{"foo".localeCompare("bar","i")}catch(e){return"RangeError"===e.name}return!1},labels:function(){var e=[];if(this.trees.forEach((function(t){Array.prototype.push.apply(e,t.labels)})),this.localeCompareSupportsLocales){var t=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});e.sort((function(e,i){return t.compare(e.name,i.name)}))}else e.sort((function(e,t){return e.name<t.name?-1:1}));return e},favouriteIds:function(){return this.favourites.map((function(e){return e.id}))},canHaveMoreFavourites:function(){return this.favourites.length<10},hasFavourites:function(){return this.favourites.length>0},ownId:function(){if(this.id)return this.id;var e=[];for(var t in this.trees)this.trees.hasOwnProperty(t)&&e.push(this.trees[t].id);return e.join("-")},favouriteStorageKey:function(){return"biigle.label-trees.".concat(this.ownId,".favourites")}},methods:{handleSelect:function(e,t){e&&this.$emit("select",e,t)},handleDeselect:function(e,t){this.$emit("deselect",e,t)},clear:function(){this.$emit("clear")},handleAddFavourite:function(e){this.canHaveMoreFavourites&&(this.$emit("add-favourite",e),this.favourites.push(e),this.updateFavouriteStorage())},handleRemoveFavourite:function(e){this.$emit("remove-favourite",e);var t=this.favourites.indexOf(e);-1!==t&&this.favourites.splice(t,1),this.updateFavouriteStorage()},updateFavouriteStorage:function(){this.hasFavourites?localStorage.setItem(this.favouriteStorageKey,JSON.stringify(this.favouriteIds)):localStorage.removeItem(this.favouriteStorageKey)},selectFavourite:function(e){this.favourites[e]&&this.handleSelect(this.favourites[e])}},watch:{trees:{immediate:!0,handler:function(e){e.forEach((function(e){e.version?e.versionedName=e.name+" @ "+e.version.name:e.versionedName=e.name,e.labels.forEach((function(t){t.tree=e}))}))}}},mounted:function(){var e=this;if(this.showFavourites){var t=JSON.parse(localStorage.getItem(this.favouriteStorageKey));if(t){var i=[];this.labels.forEach((function(e){var l=t.indexOf(e.id);-1!==l&&(i[l]=e)})),i.filter(Boolean).forEach((function(t){e.handleAddFavourite(t)}))}for(var l=function(t,i){s.on(t,(function(){e.selectFavourite(i)}),0,e.listenerSet)},a=1;a<=9;a++)l(a.toString(),a-1);l("0",9)}}};biigle.$declare("labelTrees.components.labelTrees",p);var m={mixins:[u,l],data:{labelTree:null,ownProjects:[],authorizedProjects:[],authorizedOwnProjects:[],typeaheadTemplate:'<span v-text="item.name"></span><br><small v-text="item.description"></small>',privateId:null},components:{typeahead:h},computed:{isPrivate:function(){return this.labelTree.visibility_id===this.privateId},classObject:function(){return{"panel-warning":this.editing}},authorizableProjects:function(){var e=this;return this.ownProjects.filter((function(t){for(var i=e.authorizedProjects.length-1;i>=0;i--)if(e.authorizedProjects[i].id===t.id)return!1;return!0}))},hasAuthorizedProjects:function(){return this.authorizedProjects.length>0}},methods:{fetchOwnProjects:function(){var e=this;d.query().then((function(t){Vue.set(e,"ownProjects",t.body)}),n)},addAuthorizedProject:function(e){var t=this;e&&(this.startLoading(),c.addAuthorizedProject({id:this.labelTree.id},{id:e.id}).then((function(){return t.authorizedProjectAdded(e)}),n).finally(this.finishLoading))},authorizedProjectAdded:function(e){this.authorizedProjects.push(e),this.authorizedOwnProjects.push(e.id)},removeAuthorizedProject:function(e){var t=this;this.startLoading(),c.removeAuthorizedProject({id:this.labelTree.id,project_id:e.id}).then((function(){return t.authorizedProjectRemoved(e)}),n).finally(this.finishLoading)},authorizedProjectRemoved:function(e){var t;for(t=this.authorizedProjects.length-1;t>=0;t--)this.authorizedProjects[t].id===e.id&&this.authorizedProjects.splice(t,1);-1!==(t=this.authorizedOwnProjects.indexOf(e.id))&&this.authorizedOwnProjects.splice(t,1)},isOwnProject:function(e){return-1!==this.authorizedOwnProjects.indexOf(e.id)}},created:function(){this.privateId=biigle.$require("labelTrees.privateVisibilityId"),this.labelTree=biigle.$require("labelTrees.labelTree"),this.authorizedProjects=biigle.$require("labelTrees.authorizedProjects"),this.authorizedOwnProjects=biigle.$require("labelTrees.authorizedOwnProjects"),this.$once("editing.start",this.fetchOwnProjects)}},v=[0,.5,.9],g=[360,1,1],y=[0,2,2],S=function(){for(var e,t=[0,0,0],i=t.length-1;i>=0;i--)e=10*y[i],t[i]=(g[i]-v[i])*Math.random()+v[i],t[i]=0!==e?Math.round(t[i]*e)/e:Math.round(t[i]);return"#"+function(e){return e.map((function(e){return 1===(e=e.toString(16)).length?"0"+e:e}))}(function(e){var t,i=e[0]/60,l=Math.floor(i),a=i-l,n=[e[2]*(1-e[1]),e[2]*(1-e[1]*a),e[2]*(1-e[1]*(1-a))];switch(l){case 1:t=[n[1],e[2],n[0]];break;case 2:t=[n[0],e[2],n[2]];break;case 3:t=[n[0],n[1],e[2]];break;case 4:t=[n[2],n[0],e[2]];break;case 5:t=[e[2],n[0],n[1]];break;default:t=[e[2],n[2],n[0]]}return t.map((function(e){return Math.round(255*e)}))}(t)).join("")},w={props:{labels:{type:Array,required:!0},color:{type:String,default:""},parent:{type:Object,default:null},name:{type:String,default:""}},components:{typeahead:f},computed:{selectedColor:{get:function(){return this.color},set:function(e){this.$emit("color",e)}},selectedName:{get:function(){return this.name},set:function(e){this.$emit("name",e)}},selectedParent:function(){return this.parent?this.parent.name:""},hasNoLabels:function(){return 0===this.labels.length},hasNoParent:function(){return!this.parent},hasNoName:function(){return!this.name}},methods:{refreshColor:function(){this.selectedColor=S()},resetParent:function(){this.$emit("parent",null)},selectLabel:function(e){this.$emit("parent",e)}}},$={mixins:[w],methods:{submit:function(){var e={name:this.selectedName,color:this.selectedColor};this.parent&&(e.parent_id=this.parent.id),this.$emit("submit",e)}}},L={mixins:[w],components:{wormsResultItem:{props:{item:{type:Object,required:!0},recursive:{type:Boolean,required:!0},labels:{type:Array,required:!0},parent:{type:Object,default:null}},computed:{classification:function(){return this.item.parents.join(" > ")},buttonTitle:function(){return this.recursive?"Add ".concat(this.item.name," and all WoRMS parents as new labels"):this.parent?"Add ".concat(this.item.name," as a child of ").concat(this.parent.name):"Add ".concat(this.item.name," as a root label")},classObject:function(){return{"list-group-item-success":this.selected}},selected:function(){var e=this;return this.labels.some((function(t){return t.source_id==e.item.aphia_id}))}},methods:{select:function(){this.selected||this.$emit("select",this.item)}}}},data:function(){return{results:[],recursive:!1,hasSearched:!1,unaccepted:!1,worms:null}},computed:{hasResults:function(){return this.results.length>0},recursiveButtonClass:function(){return{active:this.recursive,"btn-info":this.recursive}},unacceptedButtonClass:function(){return{active:this.unaccepted,"btn-info":this.unaccepted}}},methods:{findName:function(){var e=this;this.$emit("load-start");var t={id:this.worms.id,query:this.selectedName};this.unaccepted&&(t.unaccepted="true"),o.query(t).then(this.updateResults,n).finally((function(){e.hasSearched=!0,e.$emit("load-finish")}))},updateResults:function(e){this.results=e.data},importItem:function(e){var t={name:e.name,color:this.selectedColor,source_id:e.aphia_id,label_source_id:this.worms.id};this.recursive?t.recursive="true":this.parent&&(t.parent_id=this.parent.id),this.$emit("submit",t)},toggleRecursive:function(){this.recursive=!this.recursive},toggleUnaccepted:function(){this.unaccepted=!this.unaccepted}},created:function(){this.worms=biigle.$require("labelTrees.wormsLabelSource")}},_={mixins:[u,l],data:{labelTree:null,labels:[],selectedColor:S(),selectedLabel:null,selectedName:""},components:{tabs:VueStrap.tabs,tab:VueStrap.tab,labelTree:b,manualLabelForm:$,wormsLabelForm:L},computed:{classObject:function(){return{"panel-warning":this.editing}}},methods:{saveLabel:function(e,t){this.startLoading(),r.update({id:e.id},{name:e.name,color:e.color}).catch((function(e){t(),n(e)})).finally(this.finishLoading)},deleteLabel:function(e){var t=this;this.startLoading(),r.delete({id:e.id}).then((function(){t.labelDeleted(e)}),n).finally(this.finishLoading)},labelDeleted:function(e){this.selectedLabel&&this.selectedLabel.id===e.id&&this.deselectLabel(e);for(var t=this.labels.length-1;t>=0;t--)if(this.labels[t].id===e.id){this.labels.splice(t,1);break}},selectLabel:function(e){this.selectedLabel=e,e?(this.selectedColor="#"+e.color,this.$emit("select",e),a.$emit("selectLabel",e)):(this.$emit("clear"),a.$emit("selectLabel",null))},deselectLabel:function(e){this.selectedLabel=null,this.$emit("deselect",e),a.$emit("selectLabel",null)},selectColor:function(e){this.selectedColor=e},selectName:function(e){this.selectedName=e},insertLabel:function(e){Vue.set(e,"open",!1),Vue.set(e,"selected",!1);for(var t=e.name.toLowerCase(),i=0,l=this.labels.length;i<l;i++)if(this.labels[i].name.toLowerCase()>=t)return void this.labels.splice(i,0,e);this.labels.push(e)},createLabel:function(e){this.loading||(this.startLoading(),r.save({label_tree_id:this.labelTree.id},e).then(this.labelCreated,n).finally(this.finishLoading))},labelCreated:function(e){e.data.forEach(this.insertLabel),this.selectedColor=S(),this.selectedName=""}},created:function(){this.labelTree=biigle.$require("labelTrees.labelTree"),this.labels=biigle.$require("labelTrees.labels")}};i("ux1I");biigle.$mount("label-trees-authorized-projects",m),biigle.$mount("label-trees-labels",_)},ux1I:function(e,t){biigle.$viewModel("label-trees-members",(function(e){var t=biigle.$require("messages.store"),i=biigle.$require("labelTrees.labelTree"),l=biigle.$require("api.labelTree");new Vue({el:e,mixins:[biigle.$require("core.mixins.loader")],data:{members:biigle.$require("labelTrees.members"),roles:biigle.$require("labelTrees.roles"),defaultRole:biigle.$require("labelTrees.defaultRoleId"),userId:biigle.$require("labelTrees.userId")},components:{membersPanel:biigle.$require("core.components.membersPanel")},computed:{},methods:{attachMember:function(e){this.startLoading();var a=this;l.addUser({id:i.id},{id:e.id,role_id:e.role_id}).then((function(){a.memberAttached(e)}),t.handleResponseError).finally(this.finishLoading)},memberAttached:function(e){this.members.push(e)},updateMember:function(e,a){this.startLoading();var n=this;l.updateUser({id:i.id,user_id:e.id},{role_id:a.role_id}).then((function(){n.memberUpdated(e,a)}),t.handleResponseError).finally(this.finishLoading)},memberUpdated:function(e,t){e.role_id=t.role_id},removeMember:function(e){this.startLoading();var a=this;l.removeUser({id:i.id,user_id:e.id}).then((function(){a.memberRemoved(e)}),t.handleResponseError).finally(this.finishLoading)},memberRemoved:function(e){for(var t=this.members.length-1;t>=0;t--)this.members[t].id===e.id&&this.members.splice(t,1)}}})}))},zcrr:function(e,t){}});